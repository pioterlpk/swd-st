<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<title>SWD-ST PRO</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">

<style>
:root{
--bg:#0c0f14;
--panel:#141925;
--panel2:#1b2233;
--accent:#ff2a2a;
--text:#e8eaf0;
--muted:#8c93a8;
}
*{box-sizing:border-box;font-family:Inter}
body{margin:0;background:var(--bg);color:var(--text)}
.hidden{display:none}

/* LOGIN */
#loginScreen{
height:100vh;display:flex;justify-content:center;align-items:center;
background:radial-gradient(circle at top,#300,#000)
}
.loginBox{
background:var(--panel);
padding:30px;border-radius:16px;width:320px;
box-shadow:0 0 60px #ff2a2a44
}
.loginBox h2{text-align:center;margin-bottom:20px}
.loginBox input,.loginBox button{
width:100%;padding:12px;margin-bottom:12px;
background:var(--panel2);border:none;border-radius:10px;color:var(--text)
}
.loginBox button{
background:linear-gradient(135deg,#ff2a2a,#ff6a00);
font-weight:700;cursor:pointer
}

/* APP */
header{
height:56px;background:#0f131c;
display:flex;align-items:center;justify-content:space-between;
padding:0 20px;border-bottom:1px solid #222
}
header nav button{
background:none;border:none;color:var(--text);
margin-left:14px;cursor:pointer;font-weight:600
}
header nav button:hover{color:var(--accent)}

#app{
display:grid;
grid-template-columns:380px 1fr;
height:calc(100vh - 56px)
}

/* LEFT */
#left{
background:var(--panel);
border-right:1px solid #222;
overflow:auto
}
.panelHeader{
padding:14px;font-weight:700;border-bottom:1px solid #222
}
.event{
padding:14px;border-bottom:1px solid #222;cursor:pointer
}
.event:hover{background:#ffffff08}
.event h4{margin:0;font-size:14px}
.event small{color:var(--muted)}
.details{margin-top:10px;font-size:13px}

/* BADGES */
.badge{
padding:4px 8px;border-radius:20px;font-size:11px;
display:inline-block;margin:2px;font-weight:600
}
.WOLNY{background:#2ecc71;color:#000}
.DYSPOZYCJA{background:#f1c40f;color:#000}
.W_DRODZE{background:#3498db}
.NA_MIEJSCU{background:#e74c3c}
.POWROT{background:#9b59b6}
.GOSPODARCZY{background:#7f8c8d}

/* MAP */
#map{height:100%}

/* MODAL */
.modal{
position:fixed;inset:0;
background:rgba(0,0,0,.75);
display:flex;align-items:center;justify-content:center;
z-index:9999
}
.modalBox{
background:var(--panel);
padding:20px;border-radius:16px;width:360px
}
.modalBox input,.modalBox textarea,.modalBox select,.modalBox button{
width:100%;padding:10px;margin-bottom:10px;
background:var(--panel2);border:none;border-radius:10px;color:var(--text)
}
.modalBox button{
background:linear-gradient(135deg,#ff2a2a,#ff6a00);
font-weight:700;cursor:pointer
}
.close{
float:right;background:none;border:none;color:#fff;font-size:18px;cursor:pointer
}
</style>
</head>

<body>

<!-- LOGIN -->
<div id="loginScreen">
 <div class="loginBox">
  <h2>SWD-ST PRO</h2>
  <input id="loginUser" placeholder="Login">
  <input id="loginPass" type="password" placeholder="HasÅ‚o">
  <button id="loginBtn">ZALOGUJ</button>
  <small id="loginErr" style="color:red"></small>
 </div>
</div>

<!-- APP -->
<div id="mainApp" class="hidden">
<header>
 <strong>ðŸš’ SWD-ST | DYSPONENT</strong>
 <nav>
  <button id="btnAddEvent">+ Zdarzenie</button>
  <button id="btnAddUnit">+ Jednostka</button>
 </nav>
</header>

<div id="app">
 <div id="left">
  <div class="panelHeader">Zdarzenia</div>
 </div>
 <div id="map"></div>
</div>
</div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
/* LOGIN */
document.getElementById("loginBtn").onclick = () => {
 const u = document.getElementById("loginUser").value;
 const p = document.getElementById("loginPass").value;
 if(u==="OSPLipowki" && p==="Sylwek123"){
  document.getElementById("loginScreen").style.display="none";
  document.getElementById("mainApp").classList.remove("hidden");
  initApp();
 }else{
  document.getElementById("loginErr").textContent="BÅ‚Ä™dny login lub hasÅ‚o";
 }
};

let map, events=[], units=[];

/* INIT */
function initApp(){
 initMap();
 render();
 bindButtons();
}

/* MAP */
function initMap(){
 map=L.map("map").setView([51.9,21.6],10);
 L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png").addTo(map);
}

/* BUTTONS */
function bindButtons(){
 document.getElementById("btnAddEvent").onclick = openEventModal;
 document.getElementById("btnAddUnit").onclick = openUnitModal;
}

/* MODALS (TWORZONE DYNAMICZNIE) */
function openEventModal(){
 createModal(`
  <h3>Nowe zdarzenie</h3>
  <input id="eTitle" placeholder="TytuÅ‚">
  <textarea id="eDesc" placeholder="Opis"></textarea>
  <button onclick="addEvent()">Dodaj</button>
 `);
}

function openUnitModal(){
 createModal(`
  <h3>Nowa jednostka</h3>
  <input id="uName" placeholder="Nazwa">
  <select id="uStatus">
   <option>WOLNY</option><option>DYSPOZYCJA</option>
   <option>W_DRODZE</option><option>NA_MIEJSCU</option>
   <option>POWROT</option><option>GOSPODARCZY</option>
  </select>
  <button onclick="addUnit()">Dodaj</button>
 `);
}

function createModal(html){
 closeModal();
 const m=document.createElement("div");
 m.className="modal";
 m.innerHTML=`<div class="modalBox">
  <button class="close" onclick="closeModal()">âœ–</button>${html}
 </div>`;
 document.body.appendChild(m);
}

function closeModal(){
 document.querySelectorAll(".modal").forEach(m=>m.remove());
}

/* LOGIC */
function addEvent(){
 const pos=map.getCenter();
 events.push({
  title:eTitle.value,
  desc:eDesc.value,
  time:new Date().toLocaleString(),
  pos:[pos.lat,pos.lng]
 });
 L.marker(pos).addTo(map);
 closeModal();render();
}

function addUnit(){
 units.push({name:uName.value,status:uStatus.value});
 closeModal();render();
}

function render(){
 const left=document.getElementById("left");
 left.innerHTML='<div class="panelHeader">Zdarzenia</div>';
 events.forEach(e=>{
  const d=document.createElement("div");
  d.className="event";
  d.innerHTML=`
   <h4>${e.title}</h4>
   <small>${e.time}</small>
   <div class="details hidden">
    <p>${e.desc}</p>
    ${units.map(u=>`<span class="badge ${u.status}">${u.name}</span>`).join("")}
   </div>`;
  d.onclick=()=>d.querySelector(".details").classList.toggle("hidden");
  left.appendChild(d);
 });
}
</script>

</body>
</html>
