<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<title>SWD-ST | PSP ‚Äì Powiat Garwoli≈Ñski</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>

<style>
:root {
  --red:#b30000;
  --dark:#1c1f26;
  --gray:#2a2e38;
  --light:#f4f6f9;
  --green:#2ecc71;
}

*{box-sizing:border-box;font-family:Inter;margin:0;padding:0}
body{background:var(--light)}
header{background:linear-gradient(90deg,#8b0000,var(--red));color:#fff;padding:16px 24px;display:flex;justify-content:space-between}
nav{background:var(--dark);padding:10px 20px;display:flex;gap:10px}
nav button{background:none;border:none;color:#fff;padding:10px 16px;border-radius:6px;cursor:pointer;font-weight:600}
nav button.active{background:var(--red)}
.container{display:flex;height:calc(100vh - 96px)}
.sidebar{width:260px;background:var(--gray);color:#fff;padding:20px}
.stat{background:var(--dark);padding:12px;border-radius:8px;margin-bottom:10px}
.stat strong{font-size:20px}
.main{flex:1;padding:20px;overflow:auto}
.card{background:#fff;border-radius:10px;padding:16px;margin-bottom:20px;box-shadow:0 10px 25px rgba(0,0,0,.08)}
table{width:100%;border-collapse:collapse;font-size:13px}
th,td{padding:8px;border-bottom:1px solid #eee}
.status{padding:4px 8px;border-radius:20px;font-size:11px;font-weight:600}
.active{background:#ffe6e6;color:var(--red)}
.closed{background:#e8f8ef;color:var(--green)}
button.small{padding:4px 8px;font-size:11px;border:none;border-radius:4px;cursor:pointer}
.del{background:#e74c3c;color:#fff}
.hidden{display:none}
#map{height:420px;border-radius:10px}
form input,form select,form button{width:100%;padding:8px;margin-bottom:10px}
form button{background:var(--red);color:#fff;border:none;border-radius:6px}
</style>
</head>

<body>

<header>
  <strong>SWD-ST | PSP</strong>
  <span>Powiat Garwoli≈Ñski ‚Äì DEMO</span>
</header>

<nav>
  <button class="tab active" data-tab="dash">Dashboard</button>
  <button class="tab" data-tab="events">Zdarzenia</button>
  <button class="tab" data-tab="units">Jednostki</button>
</nav>

<div class="container">
  <aside class="sidebar">
    <div class="stat"><strong id="total">0</strong><br><span>Zdarzenia</span></div>
    <div class="stat"><strong id="active">0</strong><br><span>Aktywne</span></div>
    <div class="stat"><strong>OSP</strong><br><span>na mapie</span></div>
  </aside>

  <main class="main">

    <!-- DASHBOARD -->
    <div id="dash" class="tabc">
      <div class="card">
        <h3>Mapa operacyjna</h3>
        <div id="map"></div>
        <p style="font-size:12px;margin-top:6px">üî¥ Zdarzenia ‚Äì przeciƒÖgnij marker | üîµ OSP</p>
      </div>

      <div class="card">
        <h3>Lista zdarze≈Ñ</h3>
        <table>
          <thead>
            <tr><th>ID</th><th>Typ</th><th>Miejsce</th><th>Status</th><th></th></tr>
          </thead>
          <tbody id="eventsTable"></tbody>
        </table>
      </div>
    </div>

    <!-- ZDARZENIA -->
    <div id="events" class="tabc hidden">
      <div class="card">
        <h3>Nowe zdarzenie</h3>
        <form id="addEvent">
          <input id="etype" placeholder="Typ zdarzenia" required>
          <input id="eloc" placeholder="Lokalizacja" required>
          <select id="estatus">
            <option value="active">W trakcie</option>
            <option value="closed">Zako≈Ñczone</option>
          </select>
          <button>Dodaj zdarzenie</button>
        </form>
      </div>
    </div>

    <!-- JEDNOSTKI -->
    <div id="units" class="tabc hidden">
      <div class="card">
        <h3>Jednostki OSP (sta≈Çe na mapie)</h3>
        <ul>
          <li>OSP Garwolin</li>
          <li>OSP Wilga</li>
          <li>OSP ≈Åaskarzew</li>
          <li>OSP Sobolew</li>
        </ul>
      </div>
    </div>

  </main>
</div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
/* TABS */
document.querySelectorAll('.tab').forEach(b=>{
  b.onclick=()=>{
    document.querySelectorAll('.tab,.tabc').forEach(x=>x.classList.remove('active','hidden'));
    b.classList.add('active');
    document.querySelectorAll('.tabc').forEach(c=>c.classList.add('hidden'));
    document.getElementById(b.dataset.tab).classList.remove('hidden');
  }
});

/* MAPA */
const map = L.map('map').setView([51.897,21.614],10);
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{attribution:'¬© OSM'}).addTo(map);

const eventIcon = L.icon({
  iconUrl:'https://cdn-icons-png.flaticon.com/512/482/482947.png',
  iconSize:[28,28]
});
const ospIcon = L.icon({
  iconUrl:'https://cdn-icons-png.flaticon.com/512/684/684908.png',
  iconSize:[26,26]
});

/* OSP */
[
 {n:'OSP Garwolin',c:[51.897,21.614]},
 {n:'OSP Wilga',c:[51.852,21.377]},
 {n:'OSP ≈Åaskarzew',c:[51.789,21.593]},
 {n:'OSP Sobolew',c:[51.736,21.659]}
].forEach(u=>{
  L.marker(u.c,{icon:ospIcon}).addTo(map).bindPopup(u.n);
});

const eventsTable=document.getElementById('eventsTable');
let events=[];

/* DODAJ ZDARZENIE */
document.getElementById('addEvent').onsubmit=e=>{
  e.preventDefault();
  const id='2026/'+Math.floor(Math.random()*900+100);
  const type=etype.value,loc=eloc.value,st=estatus.value;
  const marker=L.marker(map.getCenter(),{icon:eventIcon,draggable:true}).addTo(map)
    .bindPopup(`${type}<br>${loc}`);
  events.push({id,type,loc,st,marker});
  render();
  e.target.reset();
};

function render(){
  eventsTable.innerHTML='';
  let a=0;
  events.forEach((e,i)=>{
    if(e.st==='active')a++;
    const tr=document.createElement('tr');
    tr.innerHTML=`
      <td>#${e.id}</td>
      <td>${e.type}</td>
      <td>${e.loc}</td>
      <td><span class="status ${e.st}">${e.st}</span></td>
      <td><button class="small del">‚ùå</button></td>`;
    tr.querySelector('button').onclick=()=>{
      map.removeLayer(e.marker);
      events.splice(i,1);
      render();
    };
    eventsTable.appendChild(tr);
  });
  total.textContent=events.length;
  active.textContent=a;
}
</script>

</body>
</html>
